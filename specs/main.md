# Спеки

короче есть сервер

к нему можно обратиться с гет запросом
есть такие запросы

- get_files_by_keywords array[string]
- add_keywords_to_file name, array[string]
- get_keywords_by_file name


### **[Интро]**

В мире кода, где каждый байт — это стих,  
Я как в темном лесу, где нету чужих.  
Начинаю строку, и рифмы летят,  
Расскажу, что творил я, в асинхрон погрузят.

### **[Куплет 1]**

Начинаем работу — это `link_keywords_to_file`,  
Ты готов? Я открою свой код, словно стиль.  
Сначала проверим, есть ли файл в базе,  
Если нет, то добавим, я здесь будто в фазе.  
Достаю `id` файла, без лишних проблем,  
Это первый шаг в этой строчке систем.

Вытаскиваю key'и из базы, из строки,  
Теперь соединим их с теми, что только пришли.  
`HashSet` наготове — он все соберет,  
Уникальные key'и в кучу сведет.  
Теперь это множество я превращу в массив,  
`join` через точку с запятой — и готов мой мотив.

### **[Припев]**

Это код, что течет, как поток из строк,  
Каждое действие — это как мой слог.  
Обновляю все key'и, словно пишу сонет,  
В этом коде я вижу свой силуэт.

### **[Куплет 2]**

Идем дальше, обновляем таблицу,  
SQL-запрос, тут нет места для лицемерных лиц.  
`UPDATE files SET keywords` — и летит в строку,  
Теперь в базе порядок, тут нету замков.

Проходимся по key'ам, и для каждого вдруг,  
Я беру `write`-лок, будто выстрел из рук.  
Проверяю, нет ли этого key'а в `map`,  
Если нет — создаю, и это факт.  
`Arc::default()` — пустой список внутри,  
Готов к записи id, будто код для игры.

Достаю `vec`, кладу в него `id`,  
Пушу строку — это наш с тобой бой, не шути.  
Создаю копию, и вновь впереди,  
Запускаю `tokio::spawn` — асинхрон впереди.

### **[Припев]**

Это код, что течет, как поток из строк,  
Каждое действие — это как мой слог.  
Обновляю все key'и, словно пишу сонет,  
В этом коде я вижу свой силуэт.

### **[Куплет 3]**

Асинхронная запись, `vec.sort()` на лету,  
Словно строки мои, я порядок найду.  
Создаю новый файл с расширением `.keyword`,  
В него отправляю все, как в битах аккорд.  
Байты в массиве — это magic moment,  
Записываю в файл, и пусть летит, словно comment.

Использую `from_raw_parts`, здесь я мастер сна,  
Это Rust, это сила, тут нету зла.  
Байты превращаются в строки на диске,  
Каждое действие четко, будто в мыслях.

### **[Аутро]**

Вот и всё, завершён этот путь по строкам,  
Мой код — это бит, как рэп под бокалом.  
Каждая функция, каждый шаг — это трек,  
Я оксимирон в мире Rust'а, где код — мой успех.
